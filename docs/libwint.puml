@startuml



package libint #c6ffb3 {
    namespace libint2 #ffffff {
        class Atom {
            + atomic_number
            + x
            + y
            + z
        }

        class Engine {
            + const target_ptr_vec& **results**()
            + const Engine::target_ptr_vec& **calculate**()
        }

        class BasisSet {
            + size_type **size**()
            + long **nbf**()
            + size_t **max_nprim**()
            + long **max_l**()
            + const std::vector<size_t>& **shell2bf**()
        }

        class Operator {
            overlap
            kinetic
            nuclear
            coulomb
        }

        class global {
            void initialize()
            void finalize()
        }
    }
}




namespace libwint {

    class AOBasis {
        __ private members __
            - bool are_calculated_overlap_integrals
            - bool are_calculated_nuclear_integrals
            - bool are_calculated_kinetic_integrals
            - bool are_calculated_eri

            - libwint::Molecule& molecule
            - const std::string name
            - libint2::BasisSet& libint_basis

            + Eigen::MatrixXd S
            + Eigen::MatrixXd T
            + Eigen::MatrixXd V
            + Eigen::Tensor<double, 4> eri
        == constructors ==
            Basis(Molecule& molecule, const std::string& basis_name)
        __ public methods __
            + libwint::Molecule& **get_molecule**() const
            + Eigen::MatrixXd& **get_S**() const
            + Eigen::MatrixXd& **get_T**() const
            + Eigen::MatrixXd& **get_V**() const
            + Eigen::Tensor<double, 4>& **get_eri**() const

            + size_t **calculateNumBF**()
            + void **calculateOverlapIntegrals**()
            + void **calculateKineticIntegrals**()
            + void **calculateNuclearIntegrals**()
            + void **calculateTwoElectronIntegrals**()
            + void **calculateIntegrals**()
            + void **printShellSizes**()
    }


    class SOBasis {
        __ private members __
            const libwint::AOBasis& ao_basis
            const libwint::MatrixXd& C
        __ private methods __
            - Eigen::MatrixXd **constructJacobiRotationMatrix**(size_t P, size_t Q, double theta, size_t M)
            - void **transformOneElectronIntegrals**(Eigen::MatrixXd& T)
            - void **transformTwoElectronIntegrals**(Eigen::MatrixXd& T)
        == constructors ==
            SOBasis(const libwint::AOBasis& ao_basis, Eigen::MatrixXd& C)
        __ public methods __
            + void **transform**(Eigen::MatrixXd& T)
    }


    class IntegralTransformations {
        __ public methods __
            + {static} Eigen::MatrixXd **transformOneElectronIntegrals**(Eigen::MatrixXd& h, Eigen::MatrixXd& T)
            + {static} Eigen::Tensor<double, 4> **transformTwoElectronIntegrals**(Eigen::Tensor<double, 4>& g, Eigen::MatrixXd& T)

            + {static} Eigen::MatrixXd **AO_to_SO**(Eigen::MatrixXd& f_AO, Eigen::MatrixXd& C)
            + {static} Eigen::MatrixXd **SO_to_AO**(Eigen::MatrixXd& f_SO, Eigen::MatrixXd& C)
            + {static} Eigen::Tensor<double, 4> **AO_to_SO**(Eigen::Tensor<double, 4>& g_AO, Eigen::MatrixXd& C)
    }


    class LibintCommunicator {
        __ private members __
            - {static} bool is_communicating = false
        __ private methods __
            - Eigen::MatrixXd **calculateOneBodyIntegrals**(const libint2::Operator& opertype, const libint2::BasisSet& obs, const std::vector<libint2::Atom>& atoms)
            - Eigen::Tensor<double, 4> **calculateTwoElectronRepulsionIntegrals**(const libint2::BasisSet& obs, const std::vector<libint2::Atom>& atoms)
        == constructors ==
            LibintCommunicator()
        == destructor ==
            ~ ~LibintCommunicator()
    }


    class Molecule {
        __ private members __
            - std::vector<libint2::Atom> atoms
            - size_t N
            - const std::string xyz_filename
        __ private methods __
            - size_t **calculateTotalNucleicCharge**()
            - double **calculateInternuclearDistance**(const libint2::Atom& atom1, const libint2::Atom& atom2)
            - std::vector<libint2::Atom> **parseFilename**(const std::string& filename)
        == constructors ==
            Molecule(const std::string& xyz_filename)
            Molecule(const std::string& xyz_filename, int molecular_charge)
        __ public methods __
            + site_t **get_N**()

            + double **calculateInternuclearRepulsion**()
    }

}



libwint.AOBasis o--> libwint.Molecule
libwint.AOBasis *--> libwint.LibintCommunicator

libwint.LibintCommunicator *--> libint2.BasisSet
libwint.LibintCommunicator ..> libint2.Operator
libwint.LibintCommunicator *--> libint2.Engine
libwint.LibintCommunicator ..> libint2.global

libwint.Molecule *--> "1..*" libint2.Atom

libwint.SOBasis ..> libwint.IntegralTransformations
libwint.SOBasis o--> libwint.AOBasis


@enduml
